0  CLS
110 ' Prepara`„o das matrizes de respostas
120 DIM R$(19),R(19)
130 FOR K=1 TO 19:READR$(K),R(K):NEXTK
140 DATA NADAR,5,ESVAZIAR,6,ACENDER,7,DESISTIR,8,LISTAR,9,MATAR,10,ATIRAR,10,AJUDAR,11
145 DATA PEGAR,2,APANHAR,2,CARREGAR,2,COLOCAR,3,DEIXAR,3,LARGAR,3,PUXAR,4
150 DATA NORTE,1,SUL,1,LESTE,1,OESTE,1
160 ' PREPARA MATRIZES DE OBJETOS
170 READ NB
180 DIM OB(NB),OB$(NB),SI$(NB)
190 FOR I=1 TO NB:READOB(I),OB$(I),SI$(I):NEXT
200 DATA 7,4,SACO,H  um saco de bolas de gude aqui
210 DATA 14,TIJOLO,Tem um tijolo no ch„o
220 DATA 24,CORRENTE,H  uma corrente pendurada sobre o trono
230 DATA 0,REVOLVER,Tem um Rev¢lver no Ch„o
240 DATA 0,OLHO,Um Olho Cravejado de brilhante est  no Ch„o
250 DATA 22,LAMPADA,Vocˆ est  diante de uma lampada
260 DATA 0,coletor,De repente surge um coletor de impostos
270 ' posi`„o inicial
280 L=15
290 GOTO 330
300 ' achar local
310 CLS
320 RN=INT(RND(-TIME)):IF INT(RND(1)*15+1)=1 AND TA=0 THEN OB(7)=L:TA=1
330 IF L<11 THEN ONLGOSUB 0,0,0,5020,0,0,5050,5080,0,5110:GOTO 400
340 IF L<21 THEN ONL-10GOSUB5140,0,0,5180,5210,5240,5270,5300,0,0:GOTO 400
350 IF L<26 THEN ON L-20 GOSUB0,5330,0,5360
360 ' coloca os objetos em seus lugares
370 FOR I=1 TO NB:IF OB(I)=L THEN PRINT SI$(I)
380 NEXT
390 ' indicar dire`oes
400 IF L<>11 OR (LA=1 AND OB(6)=-1) THENPRINT:PRINT"Pode seguir ";ELSE460
410 IFN>0 THEN PRINTTAB(13);"Norte"
420 IFE>0 THEN PRINTTAB(13);"Leste"
430 IFS>0 THEN PRINTTAB(13);"Sul"
440 IFW>0 THEN PRINTTAB(13);"Oeste"
450 ' intru`oes
460 PRINT:LINE INPUT"ComandoWÏ";I$
470 GOSUB 3010
480 IF OB(7)=L AND I<>10 THEN 1590
500 ' SELECIONA OP~AO
505 IF I=0 THEN GOTO 520
510 ON I GOTO 1010,1150,1240,1310,1410,1460,1500,1360,1080,1550,3110
520 PRINT:PRINT"EU NAO SEI COMO ";V$:GOTO 370
1000 ' rotina de movimenta`ao
1010 IF I$="N" AND N>0 THEN L=L-6:GOTO310
1020 IF I$="L" AND E>0 THEN L=L+1:GOTO310
1030 IF I$="S" AND S>0 THEN L=L+6:GOTO310
1040 IF I$="O" AND W>0 THEN L=L-1:GOTO310
1050 ' SE NAO PUDER...
1060 PRINT:PRINT"COMANDO - ";V$;" IMPOSSIVEL":GOTO 330
1070 ' LISTAR
1080 PRINT"VOCE TEM ";:IN=0
1090 FOR G=1 TO NB
1100 IF OB(G)=-1THEN PRINTTAB(10);OB$(G):IN=IN+1
1110 NEXT
1120 IF IN=0 THEN PRINT "NADA"
1130 GOTO 330
1140 ' PEGAR
1150 FOR G=1 TO NB
1160 IF INSTR(OB$(G),N$)=1 THEN GOTO 1190
1170 NEXT
1180 PRINTN$;"?":GOTO 330
1190 IF OB(G)=-1 THEN PRINT"Vocˆ pegou":GOTO 330
1200 IF OB(G)<>L THEN PRINT"N„o est  aqui":GOTO 330
1210 PRINT"OK":OB(G)=-1
1220 GOTO 330
1230 ' deixar
1240 FOR G=1 TO NB
1250 IF INSTR(OB$(G),N$)=1 THEN 1270
1260 NEXT:PRINTN$;"?":GOTO320
1270 IF OB(G)<>-1 THEN PRINT"VOCE NŽO PODE ";V$;" O QUE NAO TEM":GOTO 330
1280 PRINT"OK":OB(G)=L
1290 GOTO 330
1300 ' PUXAR
1310 IN=INSTR("CORRENTE",N$):IF IN=1 AND L<>24 THEN PRINT"NADA ACONTECE":GOTO 330
1320 IF IN<>1 THEN PRINT"VOCE NŽO PODE PUXAR ISSO !":GOTO 330
1330 IF OB(5)<>-1 THEN PRINT"VOCE CAI DENTRO DO VAZO E VAI EMBORA COM A DESCARGA":GOTO 1360
1360 END
1400 ' NADAR
1410 IF L<>7 THEN PRINT"NADAR ONDE ?":GOTO 400
1420 IF B(2)=-1 THEN PRINT "Que vergonha, vocˆ se afogou!":GOTO 330
1430 IF B(4)>-1 THEN PRINT"VOCE ACHOU UM REVOLVER":OB(4)=-1:GOTO 330
1440 PRINT "VOCE SE MOLHOU TODO:GOTO 330
1450 ' ESVAZIAR
1460 IN=INSTR("SACO",N$):IFIN<>1 THEN PRINT"ISTO NAO PODE SER ESVAZIADO":GOTO 330
1470 IF OB(1)<>-1 THEN G=1:GOTO 1270
1480 PRINT"AS BOLINHAS ESPALHAM PELO CHAO":OB(5)=L:GOTO 370
1540 'matar
1550 IF OB(4)<>-1 THEN PRINT"Com o que ?":GOTO 320
1560 IF OB(7)<>L THEN PRINT V$;" Quem ?":GOTO 320
1570 PRINT"Voc‰ matou o ";OB$(7):OB(7)=0:GOTO 330
1580 ' COLETOR DE IMPOSTOS
1590 IN=0:OB(7)=0
1600 FOR K=1 TO NB
1610 IF OB(K)=-1 THEN IN=IN+1
1620 NEXT
1630 IF IN=0 THEN PRINT"Como Vocˆ n„o tem nada que possa ser confiscado, ele o prende em uma masmorra imunda":GOTO 1360
1640 K=INT(RND(1)*NB+1):IF OB(K)<>-1 THEN 1640
1650 PRINT"Ele toma o ";OB$(K);" de vocˆ":OB(K)=0:GOTO 330
3000 ' instru`ao de checagem
3010 N$="":I=INSTR(I$," ")
3020 IF I=0 THEN V$=I$:GOTO 3050
3030 V$=LEFT$(I$,I-1)
3040 N$=MID$(I$,I+1)
3050 I=0
3060 FOR K=1 TO 19
3070 IF INSTR(R$(K),V$)=1 THEN I=R(K):I$=LEFT$(V$,1)
3080 NEXT
3090 RETURN
3100 ' AJUDAR
3110 IF L<>7 OR B(2)<>-1 THENPRINT"DESCULPE NAO POSSO AJUDAR AGORA":GOTO 330
3120 PRINT"Tijolos s„o muito pesados. Seu bra`o deve estar doendo.":GOTO 330
5000 REM***descri`ao do locais***
5010 ' local 4
5020 PRINT"Vocˆ est  do lado de fora de uma grande constru`„o"
5030 N=0:E=0:S=1:W=0:RETURN
5040 'local7
5050 PRINT"Vocˆ est  … beira de um grande rio"
5060 S=0:E=1:S=0:W=0:RETURN
5070 'local8
5080 PRINT"Vocˆ est  numa Floresta petrificada"
5090 N=0:E=0:S=1:W=1:RETURN
5100 'local10
5110 PRINT"Vocˆ est  numa sala muito empoeirada"
5120 N=1:E=1:S=1:W=0:RETURN
5130 'local 11
5140 PRINT"Vocˆ est  num quarto escuro"
5150 IF OB(6)<>-1 OR LA<>1 THEN N=0:E=0:S=1:W=1:PRINT"Est  muito escuro para ver as saidas":RETURN
5160 N=0:E=1:S=0:W=0:RETURN
5170 'local 14
5180 PRINT"Vocˆ est  num atalho enlameado"
5190 N=1:E=1:S=0:W=0:RETURN
5200 ' local 15
5210 PRINT"Vocˆ est  na entrada da cidade oculta"
5220 N=0:E=1:S=0:W=1:RETURN
5230 ' local 16
5240 PRINT"Vocˆ est  no HALL de entrada"
5250 N=1:E=1:S=1:W=1:RETURN
5260 'local 17
5270 PRINT"Vocˆ est  no p tio"
5280 N=1:E=1:S=0:W=1:RETURN
5290 ' local 18
5300 PRINT"Vocˆ est  no jardim"
5310 N=0:E=0:S=1:W=1:RETURN
5320 'local 22
5330 PRINT"Vocˆ est  no guarda lou`as"
5340 N=1:E=0:S=0:W=0:RETURN
5350 ' local 24
5360 PRINT"Vocˆ est  na sala do trono"
5370 N=1:E=0:S=0:W=0:RETURN
