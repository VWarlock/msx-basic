5 COLOR 1,15,15:SCREEN 2:POKE&HFCAB,1
10 FORX=1TO16:READA:NEXTX:GOSUB9200:RESTORE
15 DRAW"bm10,40;s30;c1":A$="OTHELLO":GOSUB9300
20 DRAW"bm26,120;s10;c2":A$="QUER JOGAR PRIMEIRO":GOSUB9300:DRAW"bm90,140":A$="S OU N":GOSUB9300
21 X$=INPUT$(1)
25 COLOR 15,4,4
30 IFX$<>"N"ANDX$<>"S"THEN21
40 CP=1:IFX$="N"THENCP=2
100 DIM B(8,8),C(8),D(8,2),X(60),Y(60),N(60)
110 B(4,4)=1:B(4,5)=2:B(5,4)=2:B(5,5)=1
120 FORF=1TO8:READA:D(F,1)=A:READA:D(F,2)=A:NEXTF
130 DATA -1,-1,0,-1,1,-1,-1,0,1,0,-1,1,0,1,1,1
150 GOSUB 1100
500 GOSUB1000
505 IFCS+PS=64THEN4000
510 EG=0:IFCP=1THENGOSUB2000:GOSUB1000:LINE(112,150)-(144,180),1,BF:IFEG=1THEN4000
515 IFCS+PS=64THEN4000
520 IFCP=2THENGOSUB3000
530 GOTO500
1000 PS=0:CS=0
1010 FORF=1TO8:FORG=1TO8
1030 IF B(F,G)=1 THEN LINE((G-1)*16+64,(F-1)*16+12)-(G*16+64,F*16+12),15,BF:PS=PS+1
1040 IF B(F,G)=2THENLINE((G-1)*16+64,(F-1)*16+12)-(G*16+64,F*16+12),1,BF:CS=CS+1
1050 NEXTG,F
1060 DRAW"BM10,90;C1":A$="VOCE":GOSUB9300:DRAW"BM200,90":A$="GENIO":GOSUB9300
1063 LINE(20,110)-(28,118),15,BF:LINE(220,110)-(228,118),1,BF
1065 LINE(5,60)-(42,80),1,BF:LINE(205,60)-(242,80),1,BF
1066 DRAW"BM12,62;S16;C15":A$=MID$(STR$(PS),2):GOSUB9300:DRAW"BM212,62":A$=MID$(STR$(CS),2):GOSUB9300:DRAW"S8"
1070 RETURN
1100 CLS:FORX=0TO7:DRAW"BM"+STR$(X*16+70)+",0;S8"+NU$(X+1):NEXTX
1110 LINE(64,12)-(192,140),2,BF
1120 24557bAND8:LINE(X*16+64,12)-(X*16+64,140),1:NEXT
1130 FORY=0TO8:LINE(64,Y*16+12)-(192,Y*16+12),1:NEXT
1140 FORY=0TO7:DRAW"C15S8BM54,"+STR$(Y*16+14)+NU$(Y+1):NEXT
1150 RETURN
2000 LINE(0,182)-(255,191),1,BF:LINE(112,150)-(144,180),1,BF:DRAW"C15;BM10,182":A$="SUA JOGADA LINHA E COLUNA":GOSUB9300
2001 I$=INPUT$(1):IFI$<"0"ORI$>"9"THEN2001
2002 X=VAL(I$):DRAW"BM114,154;S16;C15"+NU$(X)
2003 I$=INPUT$(1):IFI$<"0"ORI$>"9"THEN2001
2004 Y=VAL(I$):DRAWNU$(Y)+"S8"
2005 IF X=0THEN EG=1:RETURN
2006 IFX=9THENCP=2:RETURN
2010 IFX<1ORX>8ORY<1ORY>8THEN2000
2020 IFB(X,Y)=0THEN2070
2040 LINE(0,182)-(255,191),1,BF:DRAW"S8C15BM50,182":A$="QUADRADO OCUPADO":GOSUB9300:FORF=1TO900:NEXTF
2050 GOTO 2000
2070 NF=0:FORF=1TO8:CF=0:IFX+D(F,1)=0 OR X+D(F,1)=9THEN2075
2071 IFY+D(F,2)=0OR Y+D(F,2)=9THEN2075
2072 IFB(X+D(F,1),Y+D(F,2))=2THENCF=1:NF=1
2075 C(F)=0:IFCF=1THENC(F)=F
2080 NEXTF
2090 IFNF=1THEN2120
2100 LINE(0,182)-(255,191),1,BF:DRAW"C15S8BM50,182":A$="LONGE DA JOGADA":GOSUB9300:FORF=1TO900:NEXTF
2110 GOTO 2000
2120 RF=0:FORQ=1TO8:IFC(Q)=0THEN2170
2130 XP=X:YP=Y
2140 XP=XP+D(Q,1):YP=YP+D(Q,2):IFXP=0ORXP=9ORYP=0ORYP=9THENC(Q)=0:GOTO2170
2145 IFB(XP,YP)=2THEN2140
2150 IFB(XP,YP)=1THENRF=1:GOTO2170
2160 IFB(XP,YP)=0THENC(Q)=0
2170 NEXTQ
2180 IFRF=1THEN2210
2190 LINE(0,182)-(255,191),1,BF:DRAW"C15S8BM10,182":A$="JOGADA NAO GANHA TRILHA":GOSUB9300:FORF=1TO900:NEXTF
2200 GOTO 2000
2210 FORQ=1TO8:IFC(Q)=0THEN2250
2220 XP=X+D(Q,1):YP=Y+D(Q,2)
2230 IFB(XP,YP)=1THEN2250
2240 B(XP,YP)=1:XP=XP+D(Q,1):YP=YP+D(Q,2):GOTO2230
2250 NEXTQ
2260 B(X,Y)=1
2270 CP=2:RETURN
3000 LINE(0,182)-(255,191),1,BF:DRAW"S8C15BM30,182":A$="AGUARDE GENIO PENSANDO":GOSUB9300:NF=1:MX=0:FORX=1TO8:FORY=1TO8:BEEP
3010 IFB(X,Y)<>0THEN3070
3020 FORF=1TO8:XP=X:YP=Y:DX=D(F,1):DY=D(F,2):RF=0
3030 XP=XP+DY:YP=YP+DX:IFXP=0ORXP=9ORYP=0ORYP=9THEN3060
3040 IFB(XP,YP)=1THENRF=1:GOTO3030
3050 IFB(XP,YP)=2ANDRF=1THENN(NF)=F:X(NF)=X:Y(NF)=Y:NF=NF+1:F=9
3060 NEXTF
3070 NEXTY,X:NF=NF-1
3075 IF NF=0 THEN 3300
3080 FORF=1TONF:X=X(F):Y=Y(F):DX=D(N(F),1):DY=D(N(F),2):CF=0
3090 X=X+DY:Y=Y+DX:IFB(X,Y)=1THENCF=CF+1:GOTO3090
3100 IF CF>MXTHENMX=CF:MF=F
3110 NEXTF
3180 FORF=1TO8:X=X(MF):Y=Y(MF):DX=D(F,1):DY=D(F,2)
3190 X=X+DY:Y=Y+DX
3195 IFX<1ORX>8ORY<1ORY>8THEN3260
3200 IFB(X,Y)=1THEN3190
3210 IFB(X,Y)=2THEN3230
3220 IFB(X,Y)=0THEN3260
3230 X=X(MF):Y=Y(MF)
3235 B(X,Y)=2:X=X+DY:Y=Y+DX
3240 IFB(X,Y)=2THEN3260
3250 GOTO 3235
3260 NEXTF
3265 DRAW"S16BM114,154"+NU$(X(MF))+NU$(Y(MF))+"S8"
3270 CP=1:RETURN
3300 LINE(0,182)-(255,191),1,BF:DRAW"C15S8BM50,182":A$="NAO POSSO JOGAR":GOSUB9300:FORF=1TO900:NEXTF:CP=1:RETURN
9100 DATA BR4,ND4R3D2NL3ND2BE2,ND4R3DNL2FDNL3BU4BR2,NR3D4R3BU4BR2,ND4R2FD2GL2BE4BR,NR3D2NR2D2R3BU4BR2
9110 DATA NR3D2NR2D2BE4BR,NR3D4R3U2LBE2BR,D4BR3U2NL3U2BR2,ND4BR2,BD4REU3L2R3BR2,D2ND2NF2E2BR2
9120 DATA D4R3BU4BR2,ND4FREND4BR2,ND4F3DU4BR2,NR3D4R3U4BR2,ND4R3D2NL3BE2,NR3D4R3NHU4BR2
9130 DATA ND4R3D2L2F2BU4BR2,BD4R3U2L3U2R3BR2,RND4RBR2,D4R2U4BR2,D3FEU3BR2,D4EFU4BR2
9140 DATA DF2DBL2UE2UBR2,DFND2EUBR2,R3G3DR3BU4BR2
9150 DATA NR2D4R2U4BR2,BDEND4BR2,R2D2L2D2R2BU4BR2,NR2BD2NR2BD2R2U4BR2,D2R2D2U4BR2,NR2D2R2D2L2BE4,D4R2U2L2BE2BR2,R2ND4BR2,NR2D4R2U2NL2U2BR2,NR2D2R2D2U4BR2
9200 DIMLE$(26)
9210 FORK=0TO26:READLE$(K):NEXT
9220 FORK=0TO9:READNU$(K):NEXT
9230 RETURN
9300 FORK=1TOLEN(A$)
9310 B$=MID$(A$,K,1)
9320 IFB$>="0"ANDB$<="9"THENDRAWNU$(VAL(B$)):GOTO9350
9330 IFB$=" " THEN N=0 ELSE N=ASC(B$)-64
9340 DRAWLE$(N)
9350 NEXT
9360 RETURN
